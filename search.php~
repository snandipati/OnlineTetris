<?php
if($_GET) {
 try {
  $dbconn = new PDO("mysql:dbname=imdb_small;host=localhost",
    "root", "password");
  $dbconn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
 
  //$_SESSION['addactor']['outmessage'] = 'Success... ' . $mysqli->host_info . "\n";
  if(isset($_GET['q_actor'])) {
   // select actors whose lastname start with user input chars
   $query_string = "SELECT * FROM actors WHERE last_name like '{$_GET['q_actor']}%' LIMIT 10";
  }
  if(isset($_GET['searchmovie'])) {
   $query_string = "SELECT * FROM movies WHERE name like '%{$_GET['movietitle']}%' LIMIT 5";
  }
  $rows = $dbconn->query($query_string);
  
$result="";   // result string
  
  foreach($rows as $row) {
   // create result string
   $result .= $row['first_name'].'-'.$row['last_name'].'-'.$row['gender']."\n";
 
  }
  echo $result;   // return the result to javascript
 } catch  (PDOException $e) {
  print_r($e->getMessage());
    die("Error!: " . implode('-',$e->getMessage());
 }
 
}
?>

